<%- include("../header") %>
<!-- ============================================================== -->
<!-- Start right Content here -->
<!-- ============================================================== -->
<div class="main-content">
  <div class="page-content">
    <div class="container-fluid">
      <!-- start page title -->
      <div class="row">
        <div class="col-12">
          <div class="page-title-box d-sm-flex align-items-center justify-content-between">
            <h4 class="mb-sm-0 font-size-18">Hotels</h4>

            <div class="page-title-right">
              <ol class="breadcrumb m-0">
                <li class="breadcrumb-item"><a href="javascript: void(0);">Tables</a></li>
                <li class="breadcrumb-item active">Hotels</li>
              </ol>
            </div>

          </div>
        </div>
      </div>
      <!-- end page title -->

      <div class="row">
        <div class="col-xl-12">
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h4 class="card-title mb-0">Hotels List</h4>

              <!-- SUMMARY -->
              <span class="text-muted small">
                Total: <strong><%= typeof totalHotels !== 'undefined' ? totalHotels : hotels.length %></strong> hotels
              </span>
            </div>

            <div class="card-body">

              <!-- FILTERS / SEARCH / SORT -->
              <form method="GET" class="row g-2 mb-3">

                <!-- Search -->
                <div class="col-md-4">
                  <input
                    type="text"
                    name="search"
                    class="form-control"
                    placeholder="Search by hotel name or location..."
                    value="<%= typeof search !== 'undefined' ? search : '' %>"
                  >
                </div>

                <!-- Status Filter -->
                <div class="col-md-3">
                  <select name="status" class="form-select">
                    <option value="">All Status</option>
                    <option value="active" <%= status === 'active' ? 'selected' : '' %>>Active</option>
                    <option value="inactive" <%= status === 'inactive' ? 'selected' : '' %>>Inactive</option>
                  </select>
                </div>

                <!-- Sort -->
                <div class="col-md-3">
                  <select name="sort" class="form-select">
                    <option value="newest" <%= sort === 'newest' ? 'selected' : '' %>>Newest First</option>
                    <option value="oldest" <%= sort === 'oldest' ? 'selected' : '' %>>Oldest First</option>
                    <option value="name_asc" <%= sort === 'name_asc' ? 'selected' : '' %>>Name A → Z</option>
                    <option value="name_desc" <%= sort === 'name_desc' ? 'selected' : '' %>>Name Z → A</option>
                  </select>
                </div>

                <!-- Submit -->
                <div class="col-md-2 d-flex">
                  <button type="submit" class="btn btn-primary w-100">
                    Apply
                  </button>
                </div>
              </form>

              <!-- Hotels Grid -->
              <div class="row">
                <% if (hotels && hotels.length > 0) { %>
                  <% hotels.forEach(hotel => { %>
                    <div class="col-md-4 mb-4">
                      <div class="card h-100 shadow-sm">

                        <!-- FIXED IMAGE SIZE -->
                        <img 
                          src="<%= hotel.hotelImages && hotel.hotelImages.length > 0 ? hotel.hotelImages[0] : '/default.jpg' %>" 
                          class="card-img-top" 
                          style="height: 220px; object-fit: cover; width: 100%;"
                        >

                        <div class="card-body d-flex flex-column">
                          <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title mb-0"><%= hotel.hotelName %></h5>
                            <% if (typeof hotel.isActive !== 'undefined') { %>
                              <span class="badge <%= hotel.isActive ? 'bg-success' : 'bg-danger' %>">
                                <%= hotel.isActive ? 'Active' : 'Inactive' %>
                              </span>
                            <% } %>
                          </div>

                          <p class="text-muted mb-1 small">
                            <i class="mdi mdi-map-marker-outline"></i>
                            <%= hotel.location %>
                          </p>

                          
                          <div class="mt-auto">
                            <!-- VIEW BUTTON FOR SINGLE HOTEL PAGE -->
                            <a href="/hotel/<%= hotel._id %>" 
                              class="btn btn-primary btn-sm waves-effect waves-light">
                              View
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  <% }) %>
                <% } else { %>
                  <p>No hotels available.</p>
                <% } %>
              </div>

              <!-- PAGINATION -->
              <% if (typeof totalPages !== 'undefined' && totalPages > 1) { %>
                <nav aria-label="Hotels pagination">
                  <ul class="pagination justify-content-center mt-3">

                    <!-- Prev -->
                    <li class="page-item <%= currentPage <= 1 ? 'disabled' : '' %>">
                      <a class="page-link"
                         href="?search=<%= search || '' %>&status=<%= status || '' %>&sort=<%= sort || '' %>&page=<%= currentPage - 1 %>">
                        Previous
                      </a>
                    </li>

                    <!-- Page numbers -->
                    <% for (let i = 1; i <= totalPages; i++) { %>
                      <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                        <a class="page-link"
                           href="?search=<%= search || '' %>&status=<%= status || '' %>&sort=<%= sort || '' %>&page=<%= i %>">
                          <%= i %>
                        </a>
                      </li>
                    <% } %>

                    <!-- Next -->
                    <li class="page-item <%= currentPage >= totalPages ? 'disabled' : '' %>">
                      <a class="page-link"
                         href="?search=<%= search || '' %>&status=<%= status || '' %>&sort=<%= sort || '' %>&page=<%= currentPage + 1 %>">
                        Next
                      </a>
                    </li>

                  </ul>
                </nav>
              <% } %>

            </div>
          </div>
        </div>
      </div>

    </div> <!-- container-fluid -->
  </div>
  <!-- End Page-content -->
</div>

<%- include("../footer") %>
